<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Function Alignment: Inter-Layer Cross-Attention for Symbolic Music Translation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        section { scroll-margin-top: 80px; }
        /* Style for audio players */
        audio { filter: invert(75%) grayscale(100%); opacity: 0.6; transition: all 0.3s ease; }
        audio.audio-valid { filter: none; opacity: 1.0; }
        /* Style for tab buttons */
        .tab-button.active { background-color: #0ea5e9; color: white; }
        /* Style for pagination buttons */
        .page-button.active { background-color: #0f172a; color: white; border-color: #0f172a; }
    </style>
</head>
<body class="bg-slate-50 text-slate-700">

    <header class="bg-white/90 backdrop-blur-lg sticky top-0 z-50 border-b border-slate-200">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold text-slate-900">Function Alignment</h1>
            <div class="space-x-4 md:space-x-6 text-sm font-medium">
                <a href="#abstract" class="text-slate-600 hover:text-sky-600 transition-colors">Abstract</a>
                <a href="#architecture" class="text-slate-600 hover:text-sky-600 transition-colors">Architecture</a>
                <a href="#examples" class="text-slate-600 hover:text-sky-600 transition-colors">Examples</a>
                <a href="#" class="bg-sky-500 text-white px-3 py-1.5 rounded-md hover:bg-sky-600 transition-colors">Paper (Link)</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-6 md:p-10 max-w-5xl">

        <section class="text-center my-12 md:my-16">
            <h2 class="text-4xl md:text-5xl font-extrabold text-slate-900 leading-tight tracking-tight">Function Alignment: Inter-Layer Cross-Attention for Symbolic Music Translation</h2>
            <p class="mt-4 text-lg text-slate-600 max-w-3xl mx-auto">
              Xiaoyu Qian, Collaborator Name, Another Collaborator<br>
              <span class="text-base">MBZUAI</span>
            </p>
        </section>

        <section id="abstract" class="mb-20">
            <h3 class="text-3xl font-bold text-slate-900 mb-4">Abstract</h3>
            <div class="prose prose-lg max-w-none text-slate-800 leading-relaxed">
                <p>
                This work introduces a novel architecture for high-fidelity conversion between symbolic music formats. By connecting two specialized, pre-trained MIDI language models with a layer-wise cross-attention adapter, our model learns to translate the nuances between a written score and an expressive human performance. The adapter acts as a "shoelace," tying the hidden states of the two models together at every layer, enabling a deep and contextual information transfer. These examples showcase the model's ability to generate clean, readable scores from expressive performances.
                </p>
            </div>
        </section>

        <section id="architecture" class="mb-20">
            <h3 class="text-3xl font-bold text-slate-900 mb-6">Model Architecture</h3>
            <div class="bg-white p-4 rounded-xl shadow-lg border border-slate-200">
                <img src="./assets/Adapter.png" alt="Model Architecture Diagram" class="rounded-lg w-full">
                <p class="text-center mt-4 text-slate-600 italic">The adapter injects the Key (K) and Value (V) from a conditioning model (LM for x) into the cross-attention block of the target model (LM for y) at each layer.</p>
            </div>
        </section>
        
        <section id="examples" class="mb-20">
            <h3 class="text-3xl font-bold text-slate-900 mb-6">Audio Examples</h3>
            <p class="text-lg mb-8 text-slate-800">Compare our model's outputs against two baselines. Use the pagination controls at the bottom to navigate through all samples.</p>
            
            <div id="example-list" class="space-y-12">
                <p class="text-center text-slate-500">Loading examples...</p>
            </div>

            <nav id="pagination-controls" class="flex justify-center items-center space-x-2 mt-12" aria-label="Pagination"></nav>
        </section>

    </main>
    
    <footer class="text-center py-8 border-t border-slate-200 bg-white">
        <p class="text-slate-500">Function Alignment Project - MBZUAI - 2025</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            fetch('./examples.html?v=' + new Date().getTime())
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text();
                })
                .then(html => {
                    document.getElementById('example-list').innerHTML = html;
                    initializePageLogic();
                })
                .catch(error => {
                    document.getElementById('example-list').innerHTML = `<p class="text-center text-red-500 font-medium">Error: Could not load 'examples.html'. Please ensure the file exists and is in the same directory as index.html.</p>`;
                    console.error('Error fetching examples:', error);
                });

            function initializePageLogic() {
                // Logic for audio player styling
                document.querySelectorAll('audio').forEach(audioPlayer => {
                    audioPlayer.addEventListener('canplaythrough', () => audioPlayer.classList.add('audio-valid'));
                });

                // Logic for tabbed interfaces
                document.querySelectorAll('.sample-card').forEach(card => {
                    const tabs = card.querySelectorAll('.tab-button');
                    const contents = card.querySelectorAll('.tab-content');
                    tabs.forEach(tab => {
                        tab.addEventListener('click', () => {
                            tabs.forEach(t => t.classList.remove('active'));
                            tab.classList.add('active');
                            contents.forEach(c => c.classList.add('hidden'));
                            const target = card.querySelector('#' + tab.getAttribute('data-target'));
                            if(target) target.classList.remove('hidden');
                        });
                    });
                });

                // Logic for Pagination
                const itemsPerPage = 5; 
                let currentPage = 1;
                const exampleItems = document.querySelectorAll('.example-item');

                const paginationContainer = document.getElementById('pagination-controls');
                if (!exampleItems.length) return;
                
                const totalPages = Math.ceil(exampleItems.length / itemsPerPage);

                function displayPage(page) {
                    currentPage = page;
                    const startIndex = (page - 1) * itemsPerPage;
                    const endIndex = startIndex + itemsPerPage;

                    exampleItems.forEach(item => item.classList.add('hidden'));
                    
                    for (let i = startIndex; i < endIndex && i < exampleItems.length; i++) {
                        exampleItems[i].classList.remove('hidden');
                    }
                    
                    updatePaginationControls();
                }

                function updatePaginationControls() {
                    paginationContainer.innerHTML = '';
                    if (totalPages <= 1) return;

                    // Previous Button
                    const prevButton = document.createElement('button');
                    prevButton.textContent = 'â€¹ Prev';
                    prevButton.className = 'page-button px-4 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-300 rounded-md hover:bg-slate-100 disabled:opacity-50 disabled:cursor-not-allowed';
                    if (currentPage === 1) prevButton.disabled = true;
                    prevButton.addEventListener('click', () => displayPage(currentPage - 1));
                    paginationContainer.appendChild(prevButton);

                    // --- NEW: Static "Page" label ---
                    const pageLabel = document.createElement('span');
                    pageLabel.textContent = 'Page';
                    pageLabel.className = 'ml-2 mr-1 text-sm font-medium text-slate-700';
                    paginationContainer.appendChild(pageLabel);

                    // --- UPDATED: Dropdown with only numbers ---
                    const pageSelect = document.createElement('select');
                    pageSelect.className = 'px-2 py-1.5 border border-slate-300 rounded-md text-sm font-medium text-slate-700 focus:ring-2 focus:ring-sky-500 focus:border-sky-500';

                    for (let i = 1; i <= totalPages; i++) {
                        const option = document.createElement('option');
                        option.value = i;
                        option.textContent = i; // Now only the number
                        pageSelect.appendChild(option);
                    }
                    
                    pageSelect.value = currentPage; 

                    pageSelect.addEventListener('change', (event) => {
                        const newPage = parseInt(event.target.value, 10);
                        displayPage(newPage);
                    });
                    paginationContainer.appendChild(pageSelect);

                    // Next Button
                    const nextButton = document.createElement('button');
                    nextButton.textContent = 'Next â€º';
                    nextButton.className = 'page-button px-4 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-300 rounded-md hover:bg-slate-100 disabled:opacity-50 disabled:cursor-not-allowed';
                    if (currentPage === totalPages) nextButton.disabled = true;
                    nextButton.addEventListener('click', () => displayPage(currentPage + 1));
                    paginationContainer.appendChild(nextButton);
                }
                displayPage(1);
            }
        });
    </script>
</body>
</html>